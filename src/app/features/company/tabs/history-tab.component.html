<div class="p-6">
  <h3 class="text-lg font-semibold text-(--text-primary) mb-6">
    {{ 'company.history.title' | translate }}
  </h3>

  @if (loading()) {
    <div class="flex items-center justify-center py-12">
      <i class="pi pi-spinner pi-spin text-2xl text-(--text-muted)" aria-hidden="true"></i>
      <span class="sr-only">{{ 'common.loading' | translate }}</span>
    </div>
  } @else if (error()) {
    <!-- Error State -->
    <div 
      class="text-center py-12 bg-(--bg-page) rounded-lg border border-dashed border-(--danger)"
      role="alert"
    >
      <div class="bg-(--danger)/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
        <i class="pi pi-exclamation-triangle text-2xl text-(--danger)" aria-hidden="true"></i>
      </div>
      <p class="text-sm text-(--danger) font-medium">
        {{ 'company.history.loadError' | translate }}
      </p>
      <button 
        pButton 
        type="button" 
        [label]="'common.retry' | translate"
        icon="pi pi-refresh"
        class="p-button-text p-button-sm mt-3" 
        (click)="loadHistory()"
      ></button>
    </div>
  } @else if (hasHistory()) {
    <p-timeline [value]="history()" align="left">
      <ng-template pTemplate="marker" let-event>
        <div 
          [class]="'w-10 h-10 bg-(--bg-active) rounded-full flex items-center justify-center ' + getEventColor(event.type)"
          role="img"
          [attr.aria-label]="event.title"
        >
          <i [class]="getEventIcon(event.type)" aria-hidden="true"></i>
        </div>
      </ng-template>
      <ng-template pTemplate="content" let-event>
        <article class="pb-6">
          <div class="flex items-start justify-between mb-2">
            <h4 class="font-semibold text-(--text-primary)">{{ event.title }}</h4>
            <time 
              class="text-xs text-(--text-muted)" 
              [attr.datetime]="event.timestamp"
            >
              {{ event.date }}
            </time>
          </div>
          <p class="text-sm text-(--text-secondary) mb-1">{{ event.description }}</p>
          @if (event.modifiedBy) {
            <p class="text-xs text-(--text-muted) italic">
              {{ 'company.history.modifiedBy' | translate }}: {{ event.modifiedBy.name }}
              @if (event.modifiedBy.role) {
                <span class="text-(--text-muted)">({{ event.modifiedBy.role }})</span>
              }
            </p>
          }
        </article>
      </ng-template>
    </p-timeline>
  } @else {
    <!-- Empty State -->
    <div 
      class="text-center py-12 bg-(--bg-page) rounded-lg border border-dashed border-(--border-color-subtle)"
      role="status"
    >
      <div class="bg-(--bg-element) w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
        <i class="pi pi-clock text-2xl text-(--text-muted)" aria-hidden="true"></i>
      </div>
      <p class="text-sm text-(--text-muted)">
        {{ 'company.history.noHistory' | translate }}
      </p>
      <p class="text-xs text-(--text-muted) mt-1">
        {{ 'company.history.noHistoryDescription' | translate }}
      </p>
    </div>
  }
</div>
