<aside
  [style.width.px]="currentWidth()"
  [class]="classes()"
  class="sidebar flex flex-col fixed lg:static h-full py-4 z-40 transition-transform duration-300 lg:translate-x-0"
>
  <!-- Brand -->
  <div class="flex items-center justify-between px-4 pb-4">
    @if (!isSidebarCollapsed()) {
      <div class="flex items-center gap-2">
        <span class="text-(--color-primary) font-bold text-2xl">{{ 'app.name' | translate }}</span>
        <span class="bg-(--color-primary)/10 text-(--color-primary) text-(length:--space-sm) font-semibold px-2.5 py-1 rounded">
          {{ 'app.country' | translate }}
        </span>
      </div>

      @if (Collapsible()) {
        <button
          title="Toggle sidebar"
          type="button"
          (click)="toggle()"
          class="p-1.5 rounded hover:bg-gray-100 transition text-gray-600"
          [attr.aria-label]="'Collapse sidebar'"
        >
          <i class="pi pi-angle-left text-sm top-0 -right-2"></i>
        </button>
      }
    } @else {
      <div class="flex items-center justify-center w-full">
        @if (Collapsible()) {
          <button
            title="Toggle sidebar"
            type="button"
            (click)="toggle()"
            class="p-1.5 rounded hover:bg-gray-100 transition text-gray-600"
            [attr.aria-label]="'Expand sidebar'"
          >
            <i class="pi pi-angle-right text-sm"></i>
          </button>
        } @else {
          <span class="text-primary text-xl font-extrabold">PZ</span>
        }
      </div>
    }
  </div>

  <!-- Divider -->
  <div class="border-t border-gray-200"></div>

  <!-- Nav -->
  <nav
    [class]="'flex-1 flex flex-col overflow-hidden ' + (isSidebarCollapsed() ? 'gap-1 px-2 pt-4' : 'gap-4 px-4 pt-4')"
    role="navigation"
    [attr.aria-label]="'nav.mainMenu' | translate"
  >
    <app-sidebar-group>
      @if (!isSidebarCollapsed()) {
        <app-sidebar-group-label>{{ 'nav.mainMenu' | translate }}</app-sidebar-group-label>
      }

      @for (item of menuItems(); track item.label) {
        <a
          [routerLink]="item.routerLink"
          routerLinkActive="sidebar-item-active"
          class="sidebar-item"
          [class.justify-center]="isSidebarCollapsed()"
          [class.justify-start]="!isSidebarCollapsed()"
          [attr.aria-label]="item.label | translate"
          [pTooltip]="isSidebarCollapsed() ? (item.label | translate) : ''"
          tooltipPosition="right"
        >
          <i [class]="item.icon + (isSidebarCollapsed() ? '' : ' mr-2')" aria-hidden="true"></i>

          @if (!isSidebarCollapsed()) {
            <span>{{ item.label | translate }}</span>
          }
        </a>
      }
    </app-sidebar-group>
  </nav>

  <!-- User Profile -->
  <div class="m-auto space-y-2 ">
    <div class="border-t border-gray-200 mb-2"></div>

    <div
      [class]="
        'hover:bg-gray-100 flex cursor-pointer items-center rounded-md transition ' +
        (isSidebarCollapsed() ? 'mx-2 p-2 justify-center' : 'mx-4 p-2 gap-2')
      "
      [pTooltip]="isSidebarCollapsed() ? userDisplayName() : ''"
      tooltipPosition="right"
    >
      <p-avatar icon="pi pi-user" shape="circle" [size]="isSidebarCollapsed() ? 'normal' : 'normal'"></p-avatar>

      @if (!isSidebarCollapsed()) {
        <div class="flex-1">
          <div class="font-medium text-sm text-gray-900">{{ userDisplayName() }}</div>
          <div class="text-xs text-gray-500">{{ userRoleLabel() }}</div>
        </div>
        <i class="pi pi-chevron-up text-xs text-gray-400"></i>
      }
    </div>
    <div>
      @if (!isSidebarCollapsed()) {
        <!-- Logout Button (expanded) -->
  
          <ds-button
            type="button"
            size="md"
            [fullWidth]="true"
            customClass="block! w-50! space-x-2! gap-2!"
            icon="pi pi-sign-out"
            [label]="'auth.logout' | translate"
            (click)="logout()"
          ></ds-button>
      } @else {
        <!-- Logout Button (collapsed) -->
        <div class="flex justify-center px-2">
          <ds-button
            type="button"
            variant="outline"
            size="md"
            customClass="shadow-sm hover:shadow-md"
            icon="pi pi-sign-out"
            (click)="logout()"
          ></ds-button>
        </div>
      }
    </div>

  </div>
</aside>
